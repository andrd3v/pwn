## heap in os x 

[look-at-how-malloc-works-on-mac.html](https://www.cocoawithlove.com/2010/05/look-at-how-malloc-works-on-mac.html)<br>
[a-new-era-for-cocoa-with-love.html](https://www.cocoawithlove.com/blog/2016/01/25/a-new-era-for-cocoa-with-love.html)<br>
[playing-with-libmalloc](https://blackwinghq.com/blog/posts/playing-with-libmalloc/)<br>
[Sthack_2018_Heapple_Pie.pdf](https://www.synacktiv.com/ressources/Sthack_2018_Heapple_Pie.pdf)<br>

```
Nano
теперь включён по умолчанию (кроме случая MallocNanoZone=0)
диапазон: 0 < 256 байт
квант: 16 байт
```

```
Tiny
если Nano выключен — начинается с 0
диапазон: 0 ≤ 1008 байт
квант: 16 байт
```

```
Small
диапазон: 1009 байт – 32 КБ
квант: 512 байт
```

```
Medium (новый)
диапазон: 32 КБ – 8 МБ
квант: 32 КБ
```

```
Large
> 8 МБ, дальше “в бесконечность”
```

Выделение tiny происходит внутри 2 MB блока (1 MB в 32-битных программах). Все выделения округляются вверх до ближайшей 16-байтовой границы, поскольку tiny-регионы отслеживают выделения с разрешением 16 байт. Это также гарантирует 16-байтовое выравнивание всех выделений (полезно для SSE/Altivec).


```
╰─ ./dumper
data: 0x102dc1bb0
int a: 0x102dc1bb0
char name: 0x102dc1bb4
data2: 0x102dc1bc0
int a2: 0x102dc1bc0
char name2: 0x102dc1bc4
0000000102dc1b60  00 00 00 00 00 00 00 00  00 00 00 00 00 00 00 00  |................|
0000000102dc1b70  00 00 00 00 00 00 00 00  00 00 00 00 00 00 00 00  |................|
0000000102dc1b80  04 00 00 00 00 00 00 00  00 0a c0 1e 0a 00 00 00  |................|
0000000102dc1b90  00 00 00 00 00 00 00 00  00 00 00 00 00 00 00 00  |................|
0000000102dc1ba0  3c f3 e2 9f 01 00 00 00  e8 b9 1b 1b 02 00 00 00  |<...............|
0000000102dc1bb0  05 00 00 00 69 6c 79 61  61 6e 64 72 00 00 00 00  |....ilyaandr....|
0000000102dc1bc0  06 00 00 00 6e 69 6b 69  74 61 68 6d 00 00 00 00  |....nikitahm....|
0000000102dc1bd0  02 00 00 00 00 00 00 00  02 00 00 00 00 00 00 00  |................|
0000000102dc1be0  80 1b dc 02 01 00 00 00  00 00 00 00 00 00 00 00  |................|
0000000102dc1bf0  00 00 00 00 00 00 00 00  00 00 00 00 00 00 00 00  |................|
0000000102dc1c00  00 00 00 00 00 00 00 00  00 00 00 00 00 00 00 00  |................|
0000000102dc1c10  00 00 00 00 00 00 00 00  00 00 00 00 00 00 00 00  |................|
0000000102dc1c20  00 00 00 00 00 00 00 00  00 00 00 00 00 00 00 00  |................|
```

тут все по другому, нежели чем в линукс - нету сайза структуры до даты + нет инфы после

